<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=lhDjYqiy3mZ0x6ROQEUoUw);ol.lst-kix_asrdtxtrgxa5-6{list-style-type:none}ol.lst-kix_wkmsktt3hvd-2{list-style-type:none}ol.lst-kix_asrdtxtrgxa5-7{list-style-type:none}ol.lst-kix_wkmsktt3hvd-1{list-style-type:none}ol.lst-kix_asrdtxtrgxa5-4{list-style-type:none}ol.lst-kix_asrdtxtrgxa5-7.start{counter-reset:lst-ctn-kix_asrdtxtrgxa5-7 0}ol.lst-kix_wkmsktt3hvd-0{list-style-type:none}.lst-kix_wkmsktt3hvd-5>li{counter-increment:lst-ctn-kix_wkmsktt3hvd-5}ol.lst-kix_asrdtxtrgxa5-5{list-style-type:none}ol.lst-kix_wkmsktt3hvd-6{list-style-type:none}ol.lst-kix_wkmsktt3hvd-5{list-style-type:none}ol.lst-kix_asrdtxtrgxa5-8{list-style-type:none}ol.lst-kix_wkmsktt3hvd-4{list-style-type:none}ol.lst-kix_wkmsktt3hvd-3{list-style-type:none}.lst-kix_asrdtxtrgxa5-6>li{counter-increment:lst-ctn-kix_asrdtxtrgxa5-6}ol.lst-kix_asrdtxtrgxa5-0.start{counter-reset:lst-ctn-kix_asrdtxtrgxa5-0 0}.lst-kix_asrdtxtrgxa5-0>li{counter-increment:lst-ctn-kix_asrdtxtrgxa5-0}ol.lst-kix_wkmsktt3hvd-8{list-style-type:none}ol.lst-kix_wkmsktt3hvd-7{list-style-type:none}ol.lst-kix_asrdtxtrgxa5-2{list-style-type:none}ol.lst-kix_asrdtxtrgxa5-3{list-style-type:none}ol.lst-kix_wkmsktt3hvd-4.start{counter-reset:lst-ctn-kix_wkmsktt3hvd-4 0}ol.lst-kix_asrdtxtrgxa5-0{list-style-type:none}ol.lst-kix_asrdtxtrgxa5-1{list-style-type:none}ol.lst-kix_wkmsktt3hvd-7.start{counter-reset:lst-ctn-kix_wkmsktt3hvd-7 0}ol.lst-kix_asrdtxtrgxa5-3.start{counter-reset:lst-ctn-kix_asrdtxtrgxa5-3 0}ol.lst-kix_wkmsktt3hvd-5.start{counter-reset:lst-ctn-kix_wkmsktt3hvd-5 0}ol.lst-kix_asrdtxtrgxa5-1.start{counter-reset:lst-ctn-kix_asrdtxtrgxa5-1 0}.lst-kix_wkmsktt3hvd-3>li:before{content:"" counter(lst-ctn-kix_wkmsktt3hvd-3,decimal) ". "}.lst-kix_wkmsktt3hvd-4>li:before{content:"" counter(lst-ctn-kix_wkmsktt3hvd-4,lower-latin) ". "}.lst-kix_wkmsktt3hvd-4>li{counter-increment:lst-ctn-kix_wkmsktt3hvd-4}.lst-kix_wkmsktt3hvd-7>li{counter-increment:lst-ctn-kix_wkmsktt3hvd-7}.lst-kix_wkmsktt3hvd-5>li:before{content:"" counter(lst-ctn-kix_wkmsktt3hvd-5,lower-roman) ". "}.lst-kix_wkmsktt3hvd-7>li:before{content:"" counter(lst-ctn-kix_wkmsktt3hvd-7,lower-latin) ". "}.lst-kix_asrdtxtrgxa5-5>li:before{content:"" counter(lst-ctn-kix_asrdtxtrgxa5-5,lower-roman) ". "}.lst-kix_wkmsktt3hvd-6>li:before{content:"" counter(lst-ctn-kix_wkmsktt3hvd-6,decimal) ". "}ol.lst-kix_wkmsktt3hvd-8.start{counter-reset:lst-ctn-kix_wkmsktt3hvd-8 0}.lst-kix_asrdtxtrgxa5-6>li:before{content:"" counter(lst-ctn-kix_asrdtxtrgxa5-6,decimal) ". "}.lst-kix_asrdtxtrgxa5-7>li:before{content:"" counter(lst-ctn-kix_asrdtxtrgxa5-7,lower-latin) ". "}.lst-kix_asrdtxtrgxa5-7>li{counter-increment:lst-ctn-kix_asrdtxtrgxa5-7}.lst-kix_asrdtxtrgxa5-1>li{counter-increment:lst-ctn-kix_asrdtxtrgxa5-1}.lst-kix_asrdtxtrgxa5-8>li:before{content:"" counter(lst-ctn-kix_asrdtxtrgxa5-8,lower-roman) ". "}ol.lst-kix_asrdtxtrgxa5-4.start{counter-reset:lst-ctn-kix_asrdtxtrgxa5-4 0}ol.lst-kix_wkmsktt3hvd-1.start{counter-reset:lst-ctn-kix_wkmsktt3hvd-1 0}.lst-kix_wkmsktt3hvd-8>li:before{content:"" counter(lst-ctn-kix_wkmsktt3hvd-8,lower-roman) ". "}.lst-kix_asrdtxtrgxa5-4>li{counter-increment:lst-ctn-kix_asrdtxtrgxa5-4}.lst-kix_wkmsktt3hvd-8>li{counter-increment:lst-ctn-kix_wkmsktt3hvd-8}ol.lst-kix_asrdtxtrgxa5-2.start{counter-reset:lst-ctn-kix_asrdtxtrgxa5-2 0}.lst-kix_asrdtxtrgxa5-3>li{counter-increment:lst-ctn-kix_asrdtxtrgxa5-3}ol.lst-kix_asrdtxtrgxa5-5.start{counter-reset:lst-ctn-kix_asrdtxtrgxa5-5 0}.lst-kix_wkmsktt3hvd-2>li{counter-increment:lst-ctn-kix_wkmsktt3hvd-2}ol.lst-kix_wkmsktt3hvd-2.start{counter-reset:lst-ctn-kix_wkmsktt3hvd-2 0}.lst-kix_asrdtxtrgxa5-4>li:before{content:"" counter(lst-ctn-kix_asrdtxtrgxa5-4,lower-latin) ". "}.lst-kix_asrdtxtrgxa5-2>li:before{content:"" counter(lst-ctn-kix_asrdtxtrgxa5-2,lower-roman) ". "}.lst-kix_asrdtxtrgxa5-3>li:before{content:"" counter(lst-ctn-kix_asrdtxtrgxa5-3,decimal) ". "}.lst-kix_wkmsktt3hvd-1>li{counter-increment:lst-ctn-kix_wkmsktt3hvd-1}.lst-kix_asrdtxtrgxa5-1>li:before{content:"" counter(lst-ctn-kix_asrdtxtrgxa5-1,lower-latin) ". "}.lst-kix_wkmsktt3hvd-2>li:before{content:"" counter(lst-ctn-kix_wkmsktt3hvd-2,lower-roman) ". "}.lst-kix_asrdtxtrgxa5-2>li{counter-increment:lst-ctn-kix_asrdtxtrgxa5-2}.lst-kix_wkmsktt3hvd-1>li:before{content:"" counter(lst-ctn-kix_wkmsktt3hvd-1,lower-latin) ". "}ol.lst-kix_asrdtxtrgxa5-8.start{counter-reset:lst-ctn-kix_asrdtxtrgxa5-8 0}.lst-kix_asrdtxtrgxa5-0>li:before{content:"" counter(lst-ctn-kix_asrdtxtrgxa5-0,decimal) ". "}.lst-kix_asrdtxtrgxa5-5>li{counter-increment:lst-ctn-kix_asrdtxtrgxa5-5}.lst-kix_wkmsktt3hvd-0>li:before{content:"" counter(lst-ctn-kix_wkmsktt3hvd-0,decimal) ". "}ol.lst-kix_asrdtxtrgxa5-6.start{counter-reset:lst-ctn-kix_asrdtxtrgxa5-6 0}.lst-kix_asrdtxtrgxa5-8>li{counter-increment:lst-ctn-kix_asrdtxtrgxa5-8}ol.lst-kix_wkmsktt3hvd-0.start{counter-reset:lst-ctn-kix_wkmsktt3hvd-0 0}.lst-kix_wkmsktt3hvd-0>li{counter-increment:lst-ctn-kix_wkmsktt3hvd-0}.lst-kix_wkmsktt3hvd-3>li{counter-increment:lst-ctn-kix_wkmsktt3hvd-3}ol.lst-kix_wkmsktt3hvd-3.start{counter-reset:lst-ctn-kix_wkmsktt3hvd-3 0}ol.lst-kix_wkmsktt3hvd-6.start{counter-reset:lst-ctn-kix_wkmsktt3hvd-6 0}.lst-kix_wkmsktt3hvd-6>li{counter-increment:lst-ctn-kix_wkmsktt3hvd-6}ol{margin:0;padding:0}table td,table th{padding:0}.c5{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;width:468pt;border-top-color:#000000;border-bottom-style:solid}.c10{margin-left:36pt;padding-top:16pt;padding-left:0pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c29{color:#666666;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Arial";font-style:normal}.c21{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c24{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c20{padding-top:0pt;padding-bottom:16pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c27{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Arial";font-style:normal}.c17{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Arial";font-style:normal}.c7{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c19{color:#434343;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left;height:11pt}.c14{color:#666666;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:15pt;font-family:"Arial";font-style:normal}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c28{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c4{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c1{background-color:#ffffff;font-family:"Consolas";color:#a71d5d;font-weight:400}.c9{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c15{background-color:#ffffff;font-family:"Consolas";color:#df5000;font-weight:400}.c25{background-color:#ffffff;font-family:"Consolas";color:#969896;font-weight:400}.c6{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c3{background-color:#ffffff;font-family:"Consolas";color:#333333;font-weight:400}.c11{text-decoration:none;vertical-align:baseline;font-size:11pt;font-style:normal}.c16{border-spacing:0;border-collapse:collapse;margin-right:auto}.c26{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c12{padding:0;margin:0}.c8{color:inherit;text-decoration:inherit}.c22{margin-left:36pt}.c13{height:0pt}.c23{padding-left:0pt}.c30{font-size:12pt}.c18{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c26"><p class="c7 title" id="h.svv0rn2nc0s"><span class="c27">Postgres &amp; Python</span></p><p class="c20 subtitle" id="h.hyt6l9gzk7xt"><span class="c14">Eric D. Stevens</span></p><p class="c20 subtitle" id="h.d16ud3p522h3"><span>Git Repo: </span><span class="c6 c30"><a class="c8" href="https://www.google.com/url?q=https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL&amp;sa=D&amp;ust=1595560258275000&amp;usg=AOvVaw0zCpbxLpiHmLC3lKJeHp9Q">https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL</a></span></p><h2 class="c21" id="h.jle83cnevuw5"><span class="c17">Outline</span></h2><p class="c4"><span class="c6"><a class="c8" href="#h.yucnyeu1hzl0">Background</a></span><span class="c2">: General information regarding the project </span></p><p class="c4"><span class="c6"><a class="c8" href="#h.x7jeun3yaish">The Story</a></span><span class="c2">: A playful story that allowed me to conceptualize the project</span></p><p class="c4"><span class="c6"><a class="c8" href="#h.ugslnw43jjdr">Data Definition</a></span><span class="c2">: The extension to the database schema</span></p><p class="c4"><span class="c6"><a class="c8" href="#h.f2zgzm9mnpk7">Data Engineering</a></span><span class="c2">: Python generation of dummy data to allow for testing</span></p><p class="c4"><span class="c6"><a class="c8" href="#h.ejjh6c6qi72c">20 Questions</a></span><span class="c2">: 10 queries on the large original database, 10 leveraging the extension</span></p><p class="c0"><span class="c2"></span></p><h2 class="c21" id="h.yucnyeu1hzl0"><span class="c17">Background</span></h2><p class="c4"><span>This project starts out with a large pre-built database that I imported to the PSU server. I felt that integrating with a pre-existing database would be a very good exercise. I will not be including the full database in my git repo because it is several hundred megabytes and easily accessible elsewhere: The PostgreSQL implementation can be found here: </span><span class="c6"><a class="c8" href="https://www.google.com/url?q=https://github.com/vrajmohan/pgsql-sample-data/tree/master/employee&amp;sa=D&amp;ust=1595560258276000&amp;usg=AOvVaw0vgL0Fa44YGNtBcLIGTca7">https://github.com/vrajmohan/pgsql-sample-data/tree/master/employee</a></span><span>. This repository is a port to Postgres from the original MySql implementation which can be found here: </span><span class="c6"><a class="c8" href="https://www.google.com/url?q=https://github.com/datacharmer/test_db&amp;sa=D&amp;ust=1595560258277000&amp;usg=AOvVaw1AmqboaBO3O3HRVkYLfKP0">https://github.com/datacharmer/test_db</a></span><span class="c2">.</span></p><p class="c0"><span class="c2"></span></p><p class="c4"><span>This project is focused on extending the existing schema with rational components that could hypothetically extend the functionality of the database. Much of the time spent on this project was focused on the effort to synthesize data that would result in logical relationships in the schema. The amount of time and effort that went into engineering the synthetic data may have taken away from implementing a more sophisticated database, the overall product of the work performs well and accomplishes what it intends to.</span></p><p class="c0"><span class="c2"></span></p><h2 class="c21" id="h.x7jeun3yaish"><span class="c17">The story</span></h2><p class="c4"><span class="c2">I am working for a large software company that has a huge database of its employees, which departments they work for, what their salaries are and who the managers of each department are. The company, however, is not keeping track of the state of it&rsquo;s projects and the output of individual employees. As a result, the company believes it is operating inefficiently and is losing money. &nbsp;</span></p><p class="c0"><span class="c2"></span></p><p class="c4"><span class="c2">The executives have contracted me to build out their database to provide more insight into the performance at the project management level, as well as at individual contributor level. To do this they have agreed to build out a front end system that will allow employees to summarize what they have been working on in a given time period. They want me to build out a back end to store the employee self reporting records, as well as a number of other organizational relations that will help them locate inefficiencies in their company. The database schema that they currently have can be seen below.</span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c28"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 338.82px; height: 334.50px;"><img alt="" src="images/image3.png" style="width: 338.82px; height: 334.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c21" id="h.ugslnw43jjdr"><span class="c17">Data Definition</span></h2><p class="c4"><span class="c2">The DDL file for the database extension can be found at the link below.</span></p><p class="c0"><span class="c2"></span></p><p class="c4"><span class="c6"><a class="c8" href="https://www.google.com/url?q=https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL/blob/master/ddl.sql&amp;sa=D&amp;ust=1595560258278000&amp;usg=AOvVaw1aFTKmsQNUbRWEhln6R5PR">https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL/blob/master/ddl.sql</a></span></p><p class="c0"><span class="c2"></span></p><p class="c4"><span class="c2">In order to organize the information in a way that the company executives will be able to gether insight from, a schema will be created alongside the current one and attach to it. There will be five tables added to the database:</span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_wkmsktt3hvd-0 start" start="1"><li class="c4 c22 c23"><span class="c2">Project: The project table will hold the project name, the department responsible for it, and the project manager. The department will be referenced to the department table in the original database and the project manager will reference the employees table in the original database. (NOTE: the assumption is that project managers and department managers are not the same.)</span></li></ol><p class="c4 c22"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 566.72px; height: 232.50px;"><img alt="" src="images/image15.png" style="width: 566.72px; height: 232.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_wkmsktt3hvd-0" start="2"><li class="c4 c22 c23"><span>Tasks: Projects are made up of tasks, so the project table has a one to many relationship with the tasks table. Each task has a task ID and also maintains the ID of the project it belongs to. Each task will also have a task manager, who may or may not be the project manager.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 573.50px; height: 168.79px;"><img alt="" src="images/image5.png" style="width: 573.50px; height: 168.79px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li></ol><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_wkmsktt3hvd-0" start="3"><li class="c4 c22 c23"><span>Task_Team: This table will keep track of which employees are assigned to which task. Individual employees can be assigned to multiple tasks and there can be many employees assigned to each task, making this table a many to many relationship representation. The table simply has a task ID and an employee id as a compound primary key. Each of the attributes is a foregin key to its respective table.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 550.95px; height: 176.50px;"><img alt="" src="images/image11.png" style="width: 550.95px; height: 176.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li></ol><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_wkmsktt3hvd-0" start="4"><li class="c4 c22 c23"><span>Work_Log: The work log table is the one that the company is developing a front end for. It is where employees will summarize what they have been doing over a given period of time. When They enter a summary of what they have been working on, they will be entering it with respect to a task. Therefore, the work log table has both an employee ID, and a task ID as foreign keys. Each log has its own ID, space for a 1000 character summary of the work performed, a start timestamp and an end timestamp.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 575.75px; height: 268.50px;"><img alt="" src="images/image17.png" style="width: 575.75px; height: 268.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li></ol><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><h2 class="c21" id="h.f2zgzm9mnpk7"><span class="c17">Data Engineering</span></h2><p class="c4"><span class="c2">Once the schema is set up we can assume it is ready to go. Projects can be entered by the department managers and tasks and work logs can be filled out further down the corporate ladder. However, it would be very nice to test our system before we put it in production. This is where things get complicated.</span></p><p class="c0"><span class="c2"></span></p><p class="c4"><span class="c2">Since work logs and project records have not been kept track of so far, we need to synthesize artificial data. This is not a simple task, since there is a logical organization to the way projects and tasks are partitioned amongst departments. Data cannot just be entered randomly to get a sense of whether the system works. The data will be synthesized sequentially using Python and the Python PSQL library PsycoPG2.</span></p><p class="c0"><span class="c2"></span></p><h3 class="c24" id="h.csriu2z7w0q"><span class="c19">PsycoPG2 Helper Class</span></h3><p class="c4"><span class="c2">A helper class was implemented to maintain database credentials, allow for single call SQL queries, and create utilities for common SQL queries that were used to generate the random data, such as getting a single column from a table. The link to this helper class can be found with the link below.</span></p><p class="c0"><span class="c2"></span></p><p class="c4"><span class="c6"><a class="c8" href="https://www.google.com/url?q=https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL/blob/master/data_engineering/PG.py&amp;sa=D&amp;ust=1595560258281000&amp;usg=AOvVaw1bAPbmyDYjiw9Gfgf9gEnz">https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL/blob/master/data_engineering/PG.py</a></span></p><p class="c0"><span class="c2"></span></p><h3 class="c24" id="h.hwoonjy751tb"><span class="c19">Creating the Project Table</span></h3><p class="c4"><span class="c2">The project table was created by utilizing the names of the missions in the Spy database. Each project is given a name from the spy.mission table and assigned to a random department. Only specific &ldquo;senior&rdquo; job titles are allowed to be project managers, so the employee.title table is parsed through to find employee IDs that have the senior titles. They are randomly assigned as the project managers in the projects table. The code that created the data for this table can be found with the link below.</span></p><p class="c0"><span class="c2"></span></p><p class="c4"><span class="c6"><a class="c8" href="https://www.google.com/url?q=https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL/blob/master/data_engineering/create_project.py&amp;sa=D&amp;ust=1595560258282000&amp;usg=AOvVaw1wE8p-MXZViRMKWhma2TyN">https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL/blob/master/data_engineering/create_project.py</a></span></p><p class="c0"><span class="c2"></span></p><h3 class="c24" id="h.lbu64gs2e7pp"><span class="c19">Creating the Tasks Table</span></h3><p class="c4"><span class="c2">The tasks table holds tasks that are part of a project. A Project can have many tasks and a task may belong to only one project. Tasks also have managers that must come from the same department as the project is assigned to. The code for generating the task table can be found with the link below.</span></p><p class="c0"><span class="c2"></span></p><p class="c4"><span class="c6"><a class="c8" href="https://www.google.com/url?q=https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL/blob/master/data_engineering/create_tasks.py&amp;sa=D&amp;ust=1595560258283000&amp;usg=AOvVaw3OaNhVkhDe_scxxtAf_Gkt">https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL/blob/master/data_engineering/create_tasks.py</a></span></p><p class="c0"><span class="c2"></span></p><h3 class="c24" id="h.422gxk30t08b"><span class="c19">Creating the Task Team Table</span></h3><p class="c4"><span class="c2">The task team table is the relational table between collections of employees and tasks. Employees can be on multiple task teams, as long as all those tasks belong to projects under their assigned department. The code that creates the task team table can be found with the link below.</span></p><p class="c0"><span class="c2"></span></p><p class="c4"><span class="c6"><a class="c8" href="https://www.google.com/url?q=https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL/blob/master/data_engineering/create_task_team.py&amp;sa=D&amp;ust=1595560258283000&amp;usg=AOvVaw0zfrw6vOWY3wUmX8A4hwQV">https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL/blob/master/data_engineering/create_task_team.py</a></span></p><p class="c0"><span class="c2"></span></p><h3 class="c24" id="h.c8chqq0l9z8"><span class="c19">Creating the Work Log table</span></h3><p class="c4"><span class="c2">The work log table represents employees reporting on what they have been doing. Each work log contains an employee id, a task id, a start and end time stamp, and a summary that is generated from random characters. The code used to create the work log table can be found with the link below.</span></p><p class="c0"><span class="c2"></span></p><p class="c4"><span class="c6"><a class="c8" href="https://www.google.com/url?q=https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL/blob/master/data_engineering/create_worklog.py&amp;sa=D&amp;ust=1595560258284000&amp;usg=AOvVaw0emBF-Eb1wS3BkL8PdR9Fa">https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL/blob/master/data_engineering/create_worklog.py</a></span></p><p class="c0"><span class="c2"></span></p><h2 class="c21" id="h.ejjh6c6qi72c"><span class="c17">20 Questions</span></h2><p class="c4"><span class="c2">The first 10 questions are general queries of the original database. The second 10 queries leverage the extension described in this assignment. The SQL file containing these queries can be found with the link below.</span></p><p class="c0"><span class="c2"></span></p><p class="c4"><span class="c6"><a class="c8" href="https://www.google.com/url?q=https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL/blob/master/questions.sql&amp;sa=D&amp;ust=1595560258285000&amp;usg=AOvVaw12k4bujhHqMhpjrnnf2JwG">https://github.com/Eric-D-Stevens/Employee_DB_Extension_PostgreSQL/blob/master/questions.sql</a></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0 start" start="1"><li class="c10"><h3 id="h.jdi0p8beys39" style="display:inline"><span class="c19">What is the gender breakdown of the company?</span></h3></li></ol><p class="c0"><span class="c2"></span></p><a id="t.0e05f2c3f028dc36e41dc0f82690d89c42a92db8"></a><a id="t.0"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ROUND</span><span class="c3">( 100 *<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="c1">SELECT</span><span class="c3">&nbsp;</span><span class="c1">COUNT</span><span class="c3">(*)::NUMERIC <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.employees e <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">WHERE</span><span class="c3">&nbsp;e.gender = </span><span class="c15">&#39;F&#39;</span><span class="c3">)/<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="c1">SELECT</span><span class="c3">&nbsp;</span><span class="c1">COUNT</span><span class="c3">(*)::NUMERIC <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.employees)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,2 ) </span><span class="c1">as</span><span class="c3">&nbsp;Percent_Female,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ROUND</span><span class="c3">( 100 *<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="c1">SELECT</span><span class="c3">&nbsp;</span><span class="c1">COUNT</span><span class="c3">(*)::NUMERIC <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.employees e <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">WHERE</span><span class="c3">&nbsp;e.gender = </span><span class="c15">&#39;M&#39;</span><span class="c3">)/<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="c1">SELECT</span><span class="c3">&nbsp;</span><span class="c1">COUNT</span><span class="c3">(*)::NUMERIC </span><span class="c1">FROM</span><span class="c3">&nbsp;employee.employees)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,2 ) </span><span class="c1">as</span><span class="c3 c11">&nbsp;Percent_Male</span></p><p class="c9 c18"><span class="c3 c11"></span></p></td></tr></tbody></table><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 320.23px; height: 69.50px;"><img alt="" src="images/image12.png" style="width: 320.23px; height: 69.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="2"><li class="c10"><h3 id="h.a0hlk3r908g2" style="display:inline"><span class="c19">Who are the highest and lowest paid employees?</span></h3></li></ol><a id="t.ca13c9dd44886210464493cd8979a468042dcbe8"></a><a id="t.1"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;e.emp_no, e.first_name, e.last_name, sm.salary<br></span><span class="c1">FROM</span><span class="c3">&nbsp;employee.employees e<br></span><span class="c1">JOIN</span><span class="c3">&nbsp;( <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">SELECT</span><span class="c3">&nbsp;s.emp_no, s.salary<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.salaries s<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">WHERE</span><span class="c3">&nbsp;s.salary = (</span><span class="c1">SELECT</span><span class="c3">&nbsp;</span><span class="c1">MIN</span><span class="c3">(s.salary) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.salaries s)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">OR</span><span class="c3">&nbsp;s.salary = (</span><span class="c1">SELECT</span><span class="c3">&nbsp;</span><span class="c1">MAX</span><span class="c3">(s.salary) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.salaries s)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ) sm<br></span><span class="c1">ON</span><span class="c3">&nbsp;e.emp_no = sm.emp_no</span></p></td></tr></tbody></table><p class="c0"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 104.00px;"><img alt="" src="images/image18.png" style="width: 624.00px; height: 104.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="3"><li class="c10"><h3 id="h.ol4n7ha1v29b" style="display:inline"><span class="c19">How many people currently work each job title in the company?</span></h3></li></ol><a id="t.be401a767d583cfc8f324fed5cdb2ae70cf85516"></a><a id="t.2"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;t.title, </span><span class="c1">COUNT</span><span class="c3">(*) </span><span class="c1">AS</span><span class="c3">&nbsp;employee_count<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.titles t<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">WHERE</span><span class="c3">&nbsp;t.to_date &gt; </span><span class="c1">current_date</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">GROUP</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3">&nbsp;t.title</span></p></td></tr></tbody></table><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 355.50px; height: 226.44px;"><img alt="" src="images/image9.png" style="width: 355.50px; height: 226.44px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="4"><li class="c10"><h3 id="h.pe4mjksxwnd3" style="display:inline"><span class="c19">What is the average salary for each job title?</span></h3></li></ol><a id="t.2281ccd979a13b93d4f8505b0959d7632277afbf"></a><a id="t.3"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;t.title, </span><span class="c1">ROUND</span><span class="c3">(</span><span class="c1">AVG</span><span class="c3">(s.salary),2) </span><span class="c1">as</span><span class="c3">&nbsp;average_salary<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.titles t<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.salaries s<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ON</span><span class="c3">&nbsp;t.emp_no = s.emp_no<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">GROUP</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3">&nbsp;t.title<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ORDER</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3">&nbsp;average_salary</span></p></td></tr></tbody></table><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 325.94px; height: 210.50px;"><img alt="" src="images/image25.png" style="width: 325.94px; height: 210.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="5"><li class="c10"><h3 id="h.lr5z1739jp6g" style="display:inline"><span class="c19">How much do department managers make in salary relative to their employees? </span></h3></li></ol><a id="t.7d93971441afa75bab4d5940e0c73891ef0b1bba"></a><a id="t.4"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9 c18"><span class="c1 c11"></span></p><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;d.dept_name, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ROUND</span><span class="c3">(s.salary,2) </span><span class="c1">AS</span><span class="c3">&nbsp;manager_salary, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ROUND</span><span class="c3">(avg_emp_sal.average_employee_salary,2) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">AS</span><span class="c3">&nbsp;average_employee_salary<br></span><span class="c1">FROM</span><span class="c3">&nbsp;employee.departments d<br></span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.dept_manager dm<br></span><span class="c1">ON</span><span class="c3">&nbsp;d.dept_no = dm.dept_no<br></span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.salaries s<br></span><span class="c1">ON</span><span class="c3">&nbsp;s.emp_no = dm.emp_no<br></span><span class="c1">JOIN</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">SELECT</span><span class="c3">&nbsp;adepts.dept_name, </span><span class="c1">AVG</span><span class="c3">(asal.salary) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">as</span><span class="c3">&nbsp;average_employee_salary<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.salaries asal<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.dept_emp aemp<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ON</span><span class="c3">&nbsp;asal.emp_no = aemp.emp_no<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.departments adepts<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ON</span><span class="c3">&nbsp;aemp.dept_no = adepts.dept_no<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">GROUP</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3">&nbsp;adepts.dept_name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) avg_emp_sal<br></span><span class="c1">ON</span><span class="c3">&nbsp;d.dept_name = avg_emp_sal.dept_name<br></span><span class="c1">WHERE</span><span class="c3">&nbsp;dm.to_date &gt; </span><span class="c1">current_date</span><span class="c3"><br></span><span class="c1">AND</span><span class="c3">&nbsp;s.to_date &gt; </span><span class="c1">current_date</span><span class="c3 c11">;</span></p><p class="c9 c18"><span class="c3 c11"></span></p></td></tr></tbody></table><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 477.85px; height: 235.50px;"><img alt="" src="images/image19.png" style="width: 477.85px; height: 235.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="6"><li class="c10"><h3 id="h.1axw8zfjtd9p" style="display:inline"><span class="c19">How long did the current manager of the each department work for the company before becoming a manager?</span></h3></li></ol><a id="t.266f285a985c2d780262dedf9d9875c6e1521354"></a><a id="t.5"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;current_managers.dept_name </span><span class="c1">AS</span><span class="c3">&nbsp;department, <br>joined_company.start_day </span><span class="c1">AS</span><span class="c3">&nbsp;started_at_company, <br>current_managers.from_date </span><span class="c1">AS</span><span class="c3">&nbsp;started_as_manager,<br>make_interval(</span><span class="c1">years</span><span class="c3">&nbsp;=&gt; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((current_managers.from_date <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- joined_company.start_day)/365))<br></span><span class="c1">AS</span><span class="c3">&nbsp;years_working_before_manager<br></span><span class="c1">FROM</span><span class="c3">&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">SELECT</span><span class="c3">&nbsp; dm.dept_no, depts.dept_name, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dm.emp_no, dm.from_date<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.dept_manager dm<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.departments depts<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ON</span><span class="c3">&nbsp;depts.dept_no = dm.dept_no<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">WHERE</span><span class="c3">&nbsp;dm.to_date &gt; </span><span class="c1">current_date</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) current_managers<br></span><span class="c1">JOIN</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">SELECT</span><span class="c3">&nbsp;t.emp_no, </span><span class="c1">MIN</span><span class="c3">(t.from_date) </span><span class="c1">as</span><span class="c3">&nbsp;start_day<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.titles t<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.dept_manager dm<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ON</span><span class="c3">&nbsp;t.emp_no = dm.emp_no<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">GROUP</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3">&nbsp;t.emp_no<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) joined_company<br></span><span class="c1">ON</span><span class="c3">&nbsp;current_managers.emp_no = joined_company.emp_no;</span></p></td></tr></tbody></table><p class="c0"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 571.50px; height: 207.90px;"><img alt="" src="images/image1.png" style="width: 571.50px; height: 207.90px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="7"><li class="c10"><h3 id="h.k694lj19llxc" style="display:inline"><span class="c19">How many employees have held 3 different titles at the company?</span></h3></li></ol><a id="t.064edbcda37d1f25bca3f188e73e281728cefa9f"></a><a id="t.6"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;title_count.num_titles, </span><span class="c1">COUNT</span><span class="c3">(title_count.emp_no)<br></span><span class="c1">FROM</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">SELECT</span><span class="c3">&nbsp;t.emp_no, </span><span class="c1">COUNT</span><span class="c3">(t.title) </span><span class="c1">as</span><span class="c3">&nbsp;num_titles<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.titles t<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">GROUP</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3">&nbsp;t.emp_no<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ORDER</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3">&nbsp;num_titles </span><span class="c1">DESC</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) title_count<br></span><span class="c1">WHERE</span><span class="c3">&nbsp;title_count.num_titles = 3<br></span><span class="c1">GROUP</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3 c11">&nbsp;title_count.num_titles;</span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 172.50px; height: 53.91px;"><img alt="" src="images/image6.png" style="width: 172.50px; height: 53.91px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></td></tr></tbody></table><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="8"><li class="c10"><h3 id="h.y3fgzhupuxba" style="display:inline"><span class="c19">How many employees are named Eric?</span></h3></li></ol><a id="t.9c4d9e18b19d6def959e603668f4bc711c996018"></a><a id="t.7"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;</span><span class="c1">COUNT</span><span class="c3">(*) </span><span class="c1">as</span><span class="c3">&nbsp;erics_in_company<br></span><span class="c1">FROM</span><span class="c3">&nbsp;employee.employees e<br></span><span class="c1">WHERE</span><span class="c3">&nbsp;e.first_name = </span><span class="c15">&#39;Eric&#39;</span><span class="c3">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p></td></tr></tbody></table><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 146.09px; height: 49.50px;"><img alt="" src="images/image24.png" style="width: 146.09px; height: 49.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="9"><li class="c10"><h3 id="h.ov2z88kkie2f" style="display:inline"><span class="c19">How many people currently work in each department?</span></h3></li></ol><a id="t.bb2b5a4938fbf05b3a463f5ba262d82ff1933252"></a><a id="t.8"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;d.dept_name, </span><span class="c1">COUNT</span><span class="c3">(de.emp_no) </span><span class="c1">as</span><span class="c3">&nbsp;employee_count<br></span><span class="c1">FROM</span><span class="c3">&nbsp;employee.departments d<br></span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.dept_emp de<br></span><span class="c1">ON</span><span class="c3">&nbsp;d.dept_no = de.dept_no<br></span><span class="c1">WHERE</span><span class="c3">&nbsp;de.to_date &gt; </span><span class="c1">current_date</span><span class="c3"><br></span><span class="c1">GROUP</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3">&nbsp;d.dept_name;</span></p></td></tr></tbody></table><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 320.50px; height: 250.46px;"><img alt="" src="images/image16.png" style="width: 320.50px; height: 250.46px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="10"><li class="c10"><h3 id="h.st87rna1fd6i" style="display:inline"><span class="c19">How much does the company currently pay for all salaries?</span></h3></li></ol><a id="t.a16ee34ccda8504bb89ee51e6c53c4f17c7befce"></a><a id="t.9"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;</span><span class="c1">SUM</span><span class="c3">(s.salary) </span><span class="c1">AS</span><span class="c3">&nbsp;cost_of_salaries<br></span><span class="c1">FROM</span><span class="c3">&nbsp;employee.salaries s<br></span><span class="c1">WHERE</span><span class="c3">&nbsp;s.to_date &gt; </span><span class="c1">current_date</span><span class="c3">;</span></p></td></tr></tbody></table><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 175.50px; height: 62.55px;"><img alt="" src="images/image2.png" style="width: 175.50px; height: 62.55px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="11"><li class="c10"><h3 id="h.3euqj9t5540j" style="display:inline"><span class="c19">How many different projects does each department have going?</span></h3></li></ol><a id="t.c2fb457c1bf06bf1668d6eb838a35d36f61432df"></a><a id="t.10"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;d.dept_name, </span><span class="c1">COUNT</span><span class="c3">(p.proj_id) </span><span class="c1">as</span><span class="c3">&nbsp;project_count<br></span><span class="c1">FROM</span><span class="c3">&nbsp;employee.departments d<br></span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.projects p<br></span><span class="c1">ON</span><span class="c3">&nbsp;d.dept_no = p.dept_id<br></span><span class="c1">GROUP</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3">&nbsp;d.dept_name;</span></p></td></tr></tbody></table><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 299.32px; height: 246.50px;"><img alt="" src="images/image20.png" style="width: 299.32px; height: 246.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="12"><li class="c10"><h3 id="h.5yxqyxtluzj5" style="display:inline"><span class="c19">What are the names of the projects under the Human Resources department?</span></h3></li></ol><p class="c0"><span class="c2"></span></p><a id="t.80b8fa7fc5c65980dcebc820072364b2f62f77d5"></a><a id="t.11"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;d.dept_name, p.proj_name<br></span><span class="c1">FROM</span><span class="c3">&nbsp;employee.departments d<br></span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.projects p<br></span><span class="c1">ON</span><span class="c3">&nbsp;d.dept_no = p.dept_id<br></span><span class="c1">WHERE</span><span class="c3">&nbsp;d.dept_name = </span><span class="c15">&#39;Human Resources&#39;</span><span class="c3">;</span></p></td></tr></tbody></table><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 301.48px; height: 353.50px;"><img alt="" src="images/image7.png" style="width: 301.48px; height: 353.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">&nbsp;(36 Rows)</span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="13"><li class="c10"><h3 id="h.9nsneemge5s6" style="display:inline"><span class="c19">Which employees are both department managers and project managers?</span></h3></li></ol><a id="t.c8ff12409885a9f69d64f0cccf1c1970fe3bb2f7"></a><a id="t.12"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;dm.emp_no, dm.dept_no, p.proj_id<br></span><span class="c1">FROM</span><span class="c3">&nbsp;employee.dept_manager dm<br></span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.projects p<br></span><span class="c1">ON</span><span class="c3">&nbsp;dm.emp_no = p.prj_mngr;</span></p></td></tr></tbody></table><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 312.28px; height: 38.50px;"><img alt="" src="images/image4.png" style="width: 312.28px; height: 38.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">( 0 rows)</span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="14"><li class="c10"><h3 id="h.dyc005fo04y" style="display:inline"><span class="c19">Which employees are both project managers and task managers?</span></h3></li></ol><a id="t.190adf34d0dafc7d20ebed31e1e0a04d5e7b0f86"></a><a id="t.13"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;e.first_name, e.last_name, p.proj_name, t.task_id<br></span><span class="c1">FROM</span><span class="c3">&nbsp;employee.tasks t<br></span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.projects p<br></span><span class="c1">ON</span><span class="c3">&nbsp;t.task_mngr = p.prj_mngr<br></span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.employees e<br></span><span class="c1">ON</span><span class="c3">&nbsp;t.task_mngr = e.emp_no<br></span><span class="c1">WHERE</span><span class="c3">&nbsp;p.proj_id = t.project_id</span></p></td></tr></tbody></table><p class="c0"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 60.00px;"><img alt="" src="images/image14.png" style="width: 624.00px; height: 60.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="15"><li class="c10"><h3 id="h.4txlwdwyg8yj" style="display:inline"><span class="c19">What are the three most common job titles for project managers?</span></h3></li></ol><a id="t.91b53f090e148d085baa9a6930d69855e7108b78"></a><a id="t.14"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;t.title, </span><span class="c1">COUNT</span><span class="c3">(*) </span><span class="c1">AS</span><span class="c3">&nbsp;title_count<br></span><span class="c1">FROM</span><span class="c3">&nbsp;employee.titles t<br></span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.projects p<br></span><span class="c1">ON</span><span class="c3">&nbsp;t.emp_no = p.prj_mngr<br></span><span class="c1">GROUP</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3">&nbsp;t.title<br></span><span class="c1">LIMIT</span><span class="c3">&nbsp;3;</span></p></td></tr></tbody></table><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 284.50px; height: 108.09px;"><img alt="" src="images/image23.png" style="width: 284.50px; height: 108.09px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><p class="c0"><span class="c2"></span></p><a id="t.f28dc385b728979715ef6d9f8ba56045284b64a9"></a><a id="t.15"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c25">-- Creation of index for fast lookup of work performed in given range</span><span class="c3"><br></span><span class="c1">CREATE</span><span class="c3">&nbsp;</span><span class="c1">INDEX</span><span class="c3">&nbsp;work_log_timestamp_range_idx </span><span class="c1">ON</span><span class="c3">&nbsp;employee.work_log(start_timestamp, end_timestamp)</span></p></td></tr></tbody></table><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="16"><li class="c10"><h3 id="h.xe2lxsyodgea" style="display:inline"><span class="c19">How many work logs have been submitted so far this year?</span></h3></li></ol><a id="t.ef435c3567db3becad32702eb4be030e438244f6"></a><a id="t.16"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;</span><span class="c1">COUNT</span><span class="c3">(*) </span><span class="c1">AS</span><span class="c3">&nbsp;submitted_work_logs_2020<br></span><span class="c1">FROM</span><span class="c3">&nbsp;employee.work_log wl<br></span><span class="c1">WHERE</span><span class="c3">&nbsp;wl.start_timestamp &gt; </span><span class="c15">&#39;2020-01-10&#39;</span><span class="c3 c11">::DATE;</span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 234.50px; height: 59.23px;"><img alt="" src="images/image22.png" style="width: 234.50px; height: 59.23px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p><p class="c9 c18"><span class="c3 c11"></span></p></td></tr></tbody></table><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="17"><li class="c10"><h3 id="h.xe7zd9t8e064" style="display:inline"><span class="c19">Who are the 10 star employees of 2019 in terms of hours logged (most hours logged in 2019)?</span></h3></li></ol><a id="t.0539a8d78e6c3da25e277d06a9eed551b6241ac7"></a><a id="t.17"></a><table class="c16"><tbody><tr class="c13"></tr></tbody></table><p class="c9 c18"><span class="c2"></span></p><a id="t.61e5e6914aab0ac1acb0fe60f81ed994d6da415b"></a><a id="t.18"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;e.emp_no, e.first_name, e.last_name, tlog.time_logged<br></span><span class="c1">FROM</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">SELECT</span><span class="c3">&nbsp;wl.emp_no, </span><span class="c1">SUM</span><span class="c3">(wl.end_timestamp-wl.start_timestamp) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">as</span><span class="c3">&nbsp;time_logged<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.work_log wl<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">WHERE</span><span class="c3">&nbsp;wl.start_timestamp &gt;= </span><span class="c15">&#39;2019-01-01&#39;</span><span class="c3">::DATE<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">AND</span><span class="c3">&nbsp;wl.end_timestamp &lt; </span><span class="c15">&#39;2020-01-10&#39;</span><span class="c3">::DATE<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">GROUP</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3">&nbsp;wl.emp_no<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) tlog<br></span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.employees e<br></span><span class="c1">ON</span><span class="c3">&nbsp;tlog.emp_no = e.emp_no<br></span><span class="c1">ORDER</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3">&nbsp;tlog.time_logged </span><span class="c1">DESC</span><span class="c3"><br></span><span class="c1">LIMIT</span><span class="c3">&nbsp;10;</span></p></td></tr></tbody></table><p class="c0"><span class="c2"></span></p><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 570.42px; height: 271.50px;"><img alt="" src="images/image21.png" style="width: 570.42px; height: 271.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c4"><span class="c2">Note: This is obviously where the randomly generated data had some shortcomings, it is not possible for someone to log 2 years worth of hours.This is because in the generation of data employees were not restricted from working on multiple tasks in parallel. Also, the work log allowed entries to span days and even months, so this question does not make 100 percent sense for the design of the data.</span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="18"><li class="c10"><h3 id="h.epuym1yadods" style="display:inline"><span class="c19">How much time has been put into each task in the &#39;Dark Years&#39; project?</span></h3></li></ol><p class="c0"><span class="c2"></span></p><a id="t.853a3941b26da0bbd6c8a2d0e8b9c6ee071695ef"></a><a id="t.19"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;dark_year.proj_name, dark_year.task_id, <br></span><span class="c1">sum</span><span class="c3">(wl.end_timestamp - wl.start_timestamp) time_on_task<br></span><span class="c1">FROM</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">SELECT</span><span class="c3">&nbsp;p.proj_id, p.proj_name, t.project_id, t.task_id<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.projects p<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.tasks t<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ON</span><span class="c3">&nbsp;p.proj_id = t.project_id<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">WHERE</span><span class="c3">&nbsp;p.proj_name = </span><span class="c15">&#39;Dark Years&#39;</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) dark_year<br></span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.work_log wl<br></span><span class="c1">ON</span><span class="c3">&nbsp;dark_year.task_id = wl.task_id<br></span><span class="c1">GROUP</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3">&nbsp;(dark_year.proj_name, dark_year.task_id)<br></span><span class="c1">ORDER</span><span class="c3">&nbsp;</span><span class="c1">BY</span><span class="c3">&nbsp;time_on_task </span><span class="c1">DESC</span><span class="c3">;</span></p></td></tr></tbody></table><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 468.85px; height: 347.50px;"><img alt="" src="images/image8.png" style="width: 468.85px; height: 347.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c2">(33 Rows)</span></p><p class="c0"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="19"><li class="c10"><h3 id="h.sai8ra6qbm0n" style="display:inline"><span class="c19">Which employees worked on the &#39;Dark Years&#39; project in June of 2018?</span></h3></li></ol><a id="t.f8c0ef370680ad2bcc5e9c9e8cf110b8271205c3"></a><a id="t.20"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;e.emp_no, e.first_name, e.last_name<br></span><span class="c1">FROM</span><span class="c3">&nbsp;employee.employees e<br></span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.work_log wl<br></span><span class="c1">ON</span><span class="c3">&nbsp;wl.emp_no = e.emp_no<br></span><span class="c1">WHERE</span><span class="c3">&nbsp;wl.start_timestamp &gt;= </span><span class="c15">&#39;2018-06-01&#39;</span><span class="c3">::DATE<br></span><span class="c1">AND</span><span class="c3">&nbsp;wl.end_timestamp &lt; </span><span class="c15">&#39;2018-07-01&#39;</span><span class="c3">::DATE<br></span><span class="c1">AND</span><span class="c3">&nbsp;wl.task_id </span><span class="c1">IN</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">SELECT</span><span class="c3">&nbsp;t.task_id<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">FROM</span><span class="c3">&nbsp;employee.tasks t<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.projects p<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">ON</span><span class="c3">&nbsp;p.proj_id = t.project_id<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1">WHERE</span><span class="c3">&nbsp;p.proj_name = </span><span class="c15">&#39;Dark Years&#39;</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span></p></td></tr></tbody></table><p class="c9 c18"><span class="c2"></span></p><p class="c9"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 444.44px; height: 174.50px;"><img alt="" src="images/image13.png" style="width: 444.44px; height: 174.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c9 c18"><span class="c2"></span></p><p class="c9 c18"><span class="c2"></span></p><p class="c9 c18"><span class="c2"></span></p><p class="c9 c18"><span class="c2"></span></p><p class="c9 c18"><span class="c2"></span></p><p class="c9 c18"><span class="c2"></span></p><p class="c9 c18"><span class="c2"></span></p><p class="c9 c18"><span class="c2"></span></p><ol class="c12 lst-kix_asrdtxtrgxa5-0" start="20"><li class="c10"><h3 id="h.3vvkj2loglzd" style="display:inline"><span class="c19">A system crash happened on New Years 2020 at around 4:00pm! Which employees logged work on that day in the hours adjacent to the crash?</span></h3></li></ol><a id="t.aaa820ac45ae4d38e5cf0d210f6edb6ba21c2552"></a><a id="t.21"></a><table class="c16"><tbody><tr class="c13"><td class="c5" colspan="1" rowspan="1"><p class="c9"><span class="c1">SELECT</span><span class="c3">&nbsp;e.emp_no, e.first_name, e.last_name, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l.end_timestamp </span><span class="c1">AS</span><span class="c3">&nbsp;commited, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l.summary </span><span class="c1">AS</span><span class="c3">&nbsp;summary_of_work<br></span><span class="c1">FROM</span><span class="c3">&nbsp;employee.employees e<br></span><span class="c1">JOIN</span><span class="c3">&nbsp;employee.work_log l<br></span><span class="c1">ON</span><span class="c3">&nbsp;e.emp_no = l.emp_no<br></span><span class="c1">WHERE</span><span class="c3">&nbsp;l.end_timestamp &gt; </span><span class="c15">&#39;2020-01-01 15:00:00&#39;</span><span class="c3">::</span><span class="c1">TIMESTAMP</span><span class="c3"><br></span><span class="c1">AND</span><span class="c3">&nbsp;l.end_timestamp &lt; </span><span class="c15">&#39;2020-01-01 17:00:00&#39;</span><span class="c3">::</span><span class="c1">TIMESTAMP</span><span class="c3">;</span></p></td></tr></tbody></table><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 317.33px;"><img alt="" src="images/image10.png" style="width: 624.00px; height: 317.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p></body></html>